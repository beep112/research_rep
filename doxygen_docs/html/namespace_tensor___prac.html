<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Transformer fundamentals: Tensor_Prac Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Transformer fundamentals
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespace_tensor___prac.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Tensor_Prac Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a29b24be91b9caae9f81a327c14a432b0" id="r_a29b24be91b9caae9f81a327c14a432b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29b24be91b9caae9f81a327c14a432b0">main</a> ()</td></tr>
<tr class="separator:a29b24be91b9caae9f81a327c14a432b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2122dcb28c901f9e2f081014a83698" id="r_a6a2122dcb28c901f9e2f081014a83698"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a2122dcb28c901f9e2f081014a83698">print_block_size</a> (block_size, train_data)</td></tr>
<tr class="separator:a6a2122dcb28c901f9e2f081014a83698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81472eeab03df34a6e683bba8e4b388" id="r_ac81472eeab03df34a6e683bba8e4b388"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac81472eeab03df34a6e683bba8e4b388">train_val_split</a> (data)</td></tr>
<tr class="separator:ac81472eeab03df34a6e683bba8e4b388"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This file has no actual content related to tranformers or the mock GPT. This
just is some practice for myself with python, and the tensors in pytorch.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a29b24be91b9caae9f81a327c14a432b0" name="a29b24be91b9caae9f81a327c14a432b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b24be91b9caae9f81a327c14a432b0">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Tensor_Prac.main </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This will open the file and is a doxygen test</pre> 
<p class="definition">Definition at line <a class="el" href="_tensor___prac_8py_source.html#l00011">11</a> of file <a class="el" href="_tensor___prac_8py_source.html">Tensor_Prac.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span><span class="keyword">def </span>main():</div>
<div class="line"><span class="lineno">   12</span>    <span class="stringliteral">&quot;&quot;&quot;This will open the file and is a doxygen test&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   13</span>    <span class="keyword">with</span> open(os.path.dirname(__file__) + <span class="stringliteral">&quot;/../input.txt&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>, encoding=<span class="stringliteral">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">   14</span>        text = f.read()</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    print(<span class="stringliteral">&quot;length of dataset in characters: &quot;</span>, len(text))</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span>    print(text[:1000])</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>    chars = sorted(list(set(text)))</div>
<div class="line"><span class="lineno">   21</span>    vocab_size = len(chars)</div>
<div class="line"><span class="lineno">   22</span>    print(<span class="stringliteral">&quot;&quot;</span>.join(chars))</div>
<div class="line"><span class="lineno">   23</span>    print(vocab_size)</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>    <span class="stringliteral">&quot;&quot;&quot; create a mapping from characters to integers &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   26</span>    stoi = {ch: i <span class="keywordflow">for</span> i, ch <span class="keywordflow">in</span> enumerate(chars)}</div>
<div class="line"><span class="lineno">   27</span>    itos = {i: ch <span class="keywordflow">for</span> i, ch <span class="keywordflow">in</span> enumerate(chars)}</div>
<div class="line"><span class="lineno">   28</span>    <span class="stringliteral">&quot;&quot;&quot; encoder: takes a string, outputs a list of integers &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   29</span>    encode = <span class="keyword">lambda</span> s: [stoi[c] <span class="keywordflow">for</span> c <span class="keywordflow">in</span> s]</div>
<div class="line"><span class="lineno">   30</span>    <span class="stringliteral">&quot;&quot;&quot; decoder: take a list of strings, output the string &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   31</span>    decode = <span class="keyword">lambda</span> l: <span class="stringliteral">&quot;&quot;</span>.join([itos[i] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> l])</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>    print(encode(<span class="stringliteral">&quot;test message&quot;</span>))</div>
<div class="line"><span class="lineno">   34</span>    print(decode(encode(<span class="stringliteral">&quot;test message&quot;</span>)))</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <span class="stringliteral">&quot;&quot;&quot; create a tensor representation of the encoding for all the text&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   37</span>    data = torch.tensor(encode(text), dtype=torch.long)</div>
<div class="line"><span class="lineno">   38</span>    print(data.shape, data.dtype)</div>
<div class="line"><span class="lineno">   39</span>    <span class="stringliteral">&quot;&quot;&quot; print the first 1000 elements of tensor &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   40</span>    print(data[:1000])</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <span class="stringliteral">&quot;&quot;&quot; get the train/val split data &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   43</span>    train_data, val_data = train_val_split(data)</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a2122dcb28c901f9e2f081014a83698" name="a6a2122dcb28c901f9e2f081014a83698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2122dcb28c901f9e2f081014a83698">&#9670;&#160;</a></span>print_block_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Tensor_Prac.print_block_size </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>block_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function will be used to print the block size for the data.
Another way to describe block size is the amount of context that
we will look at for each pass for our model. So in this case the
block_size could be variable but for this we will fix it to 8 for
this practice model

@param block_size: the size of context we want to take in
@param train_data: the training data we are using
@return: void there is nothing returned
</pre> 
<p class="definition">Definition at line <a class="el" href="_tensor___prac_8py_source.html#l00046">46</a> of file <a class="el" href="_tensor___prac_8py_source.html">Tensor_Prac.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span><span class="keyword">def </span>print_block_size(block_size, train_data):</div>
<div class="line"><span class="lineno">   47</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    This function will be used to print the block size for the data.</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    Another way to describe block size is the amount of context that</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    we will look at for each pass for our model. So in this case the</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    block_size could be variable but for this we will fix it to 8 for</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    this practice model</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    @param block_size: the size of context we want to take in</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    @param train_data: the training data we are using</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    @return: void there is nothing returned</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   58</span>    print(train_data[: block_size + 1])</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac81472eeab03df34a6e683bba8e4b388" name="ac81472eeab03df34a6e683bba8e4b388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81472eeab03df34a6e683bba8e4b388">&#9670;&#160;</a></span>train_val_split()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Tensor_Prac.train_val_split </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>data</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function that will create a 90% split between the data for testing and validation

@param data: the data that needs to be split
@return: the training and validation data tensors
</pre> 
<p class="definition">Definition at line <a class="el" href="_tensor___prac_8py_source.html#l00061">61</a> of file <a class="el" href="_tensor___prac_8py_source.html">Tensor_Prac.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span><span class="keyword">def </span>train_val_split(data):</div>
<div class="line"><span class="lineno">   62</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    Function that will create a 90% split between the data for testing and validation</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    @param data: the data that needs to be split</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    @return: the training and validation data tensors</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    n = int(0.9 * len(data))</div>
<div class="line"><span class="lineno">   70</span>    train_data = data[:n]</div>
<div class="line"><span class="lineno">   71</span>    val_data = data[n:]</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">return</span> train_data, val_data</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_tensor___prac.html">Tensor_Prac</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
